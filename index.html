<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<style>
    *,
*::before,
*::after {
  box-sizing: border-box;
}
body {
    overflow: hidden;
}
#header {
    position: absolute;
    top: 0px;
    left: 0px;
    right: 0px;
    background-color: #484848;
    height: 50px;
    font-size: 1.5em;
    font-variant: all-petite-caps;
    text-align: center;
    padding: 10px;
    color: #eaeaea;
}
#control_panel {
    position: absolute;
    top: 50px;
    left: 0px;
    background-color: #484848;
    padding: 0px;
    border: 2px solid #c1c1c1;
    border-top:none;
    border-left:none;
    border-bottom-right-radius:20px;
    width: 240px;
}
#control_panel div {
    margin: 10px;
    font-size: 1.2em;
    font-variant: all-petite-caps;
    color: #eaeaea;
    white-space: nowrap;
}
#control_panel input {
    width: 18%;
    margin-right: 10px;
    padding:0px;
}
select {
    border: none;
    padding: 0 1em 0 0;
    margin: 0;
    line-height: inherit;
    border: none;
    margin: 0;
    position: absolute;
    left: 28px;
    width: 180px;
    font-size: 0.75em;
}
select option {
    font-size: 0.75em;
}
#clear-colors { 
    position: absolute;
    right: 20px;
    top: 13px;
    font-size: .75em;
    background-color: #8e8e8e;
    color: white;
    font-weight: 700;
    font-variant: all-petite-caps;
}
#clear-colors:hover {
    background-color: #8e8e8e;
}
</style>
</head>
<body>
    <div id="header">
        FGC9 (First Good Coloringbook)
        <select id="theme-selector" autocomplete="off">
            <option value="defaults">Default</option>
            <option value="jstark">JStark</option>
            <option value="ctrlpew">CTRL+PEW</option>
        </select>
        <button id="clear-colors">Clear</button>
    </div>
    <div id="control_panel">
        <div><input type="color" id="Barrel_Assembly" name="Barrel_Assembly" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Barrel</div>
        <div><input type="color" id="FGC-9_Barrel_Retainer_Oversized_Shaft_Collar_Pocket" name="FGC-9_Barrel_Retainer_Oversized_Shaft_Collar_Pocket" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Barrel Retainer</div>
        <div><input type="color" id="Bolt_Carrier_fgc9_mki_v1_Body1_Bolt_Carrier" name="Bolt_Carrier_fgc9_mki_v1_Body1_Bolt_Carrier" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Bolt Carrier</div>
        <div><input type="color" id="FGC-9_Buffer_Tube" name="FGC-9_Buffer_Tube" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Buffer Tube</div>
        <div><input type="color" id="FGC-9_Charging_Handle" name="FGC-9_Charging_Handle" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Charging Handle</div>
        <div><input type="color" id="Ejector_fgc9_mki_v1_Body1_Ejector" name="Ejector_fgc9_mki_v1_Body1_Ejector" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Ejector</div>
        <div><input type="color" id="Ejector_Pivot_fgc9_mki_v1_Body1_Ejector_Pivot" name="Ejector_Pivot_fgc9_mki_v1_Body1_Ejector_Pivot" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Ejector Pivot</div>
        <div><input type="color" id="Fire_Selector_Assemby" name="Fire_Selector_Assemby" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Fire Selector</div>
        <div><input type="color" id="FGC-9_Lower_Receiver" name="FGC-9_Lower_Receiver" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Lower Receiver</div>
        <div><input type="color" id="Magazine_fgc9_mki_v1_Magazine_Body_1_Body1_Magazine_Body" name="Magazine_fgc9_mki_v1_Magazine_Body_1_Body1_Magazine_Body" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Magazine</div>
        <div><input type="color" id="Magazine_Catch_Assembly_fgc9_mki_v1_Magazine_Catch_Bar_1_Body1_" name="Magazine_Catch_Assembly_fgc9_mki_v1_Magazine_Catch_Bar_1_Body1_" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Magazine Catch Bar</div>
        <div><input type="color" id="FGC-9_Pistol_Grip" name="FGC-9_Pistol_Grip" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Pistol Grip</div>
        <div><input type="color" id="FGC-9_Upper_Receiver" name="FGC-9_Upper_Receiver" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Upper Receiver</div>
        <div><input type="color" id="FGC-9_Upper_Receiver_Rail" name="FGC-9_Upper_Receiver_Rail" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Upper Receiver Rail</div>
        <div><input type="color" id="FGC-9_Stock" name="FGC-9_Stock" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Stock</div>
        <div><input type="color" id="Trigger" name="Trigger" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Trigger</div>
        <hr/>
        <div><input type="color" id="Background" name="Background" autocomplete="off" onchange="pickedColor(this)" value="#FFFFFF" >Background</div>
    </div>
<script>
var THREE, model, scene, texture, mats, amLight;
var parts = [];

var themes = {
    backup: {
        "Barrel_Assembly":"#939393",
        "Fire_Selector_Assemby":"#011da1",
        "Trigger":"#011da1",
        "FGC-9_Buffer_Tube":"#ff0000",
        "FGC-9_Charging_Handle":"#ff0000",
        "FGC-9_Lower_Receiver":"#ff0000",
        "FGC-9_Stock":"#011da1",
        "FGC-9_Upper_Receiver_Rail":"#ff0000",
        "FGC-9_Upper_Receiver":"#011da1",
        "FGC-9_Pistol_Grip":"#011da1",
        "FGC-9_Barrel_Retainer_Oversized_Shaft_Collar_Pocket":"#ff0000",
        "Bolt_Carrier_fgc9_mki_v1_Body1_Bolt_Carrier":"#ff0000",
        "Ejector_Pivot_fgc9_mki_v1_Body1_Ejector_Pivot":"#ff0000",
        "Ejector_fgc9_mki_v1_Body1_Ejector":"#ff0000",
        "Magazine_Catch_Assembly_fgc9_mki_v1_Magazine_Catch_Bar_1_Body1_":"#011da1",
        "Magazine_fgc9_mki_v1_Magazine_Body_1_Body1_Magazine_Body":"#011da1"
    },
    defaults: {
        "Barrel_Assembly":"#939393",
        "Fire_Selector_Assemby":"#011da1",
        "Trigger":"#011da1",
        "FGC-9_Buffer_Tube":"#ff0000",
        "FGC-9_Charging_Handle":"#ff0000",
        "FGC-9_Lower_Receiver":"#ff0000",
        "FGC-9_Stock":"#011da1",
        "FGC-9_Upper_Receiver_Rail":"#ff0000",
        "FGC-9_Upper_Receiver":"#011da1",
        "FGC-9_Pistol_Grip":"#011da1",
        "FGC-9_Barrel_Retainer_Oversized_Shaft_Collar_Pocket":"#ff0000",
        "Bolt_Carrier_fgc9_mki_v1_Body1_Bolt_Carrier":"#ff0000",
        "Ejector_Pivot_fgc9_mki_v1_Body1_Ejector_Pivot":"#ff0000",
        "Ejector_fgc9_mki_v1_Body1_Ejector":"#ff0000",
        "Magazine_Catch_Assembly_fgc9_mki_v1_Magazine_Catch_Bar_1_Body1_":"#011da1",
        "Magazine_fgc9_mki_v1_Magazine_Body_1_Body1_Magazine_Body":"#011da1"
    },
    jstark: {
        "Barrel_Assembly":"#939393",
        "Fire_Selector_Assemby":"#939393",
        "Trigger":"#939393",
        "FGC-9_Buffer_Tube":"#502e6a",
        "FGC-9_Charging_Handle":"#502e6a",
        "FGC-9_Lower_Receiver":"#494949",
        "FGC-9_Stock":"#502e6a",
        "FGC-9_Upper_Receiver_Rail":"#502e6a",
        "FGC-9_Upper_Receiver":"#494949",
        "FGC-9_Pistol_Grip":"#494949",
        "FGC-9_Barrel_Retainer_Oversized_Shaft_Collar_Pocket":"#502e6a",
        "Bolt_Carrier_fgc9_mki_v1_Body1_Bolt_Carrier":"#502e6a",
        "Ejector_Pivot_fgc9_mki_v1_Body1_Ejector_Pivot":"#502e6a",
        "Ejector_fgc9_mki_v1_Body1_Ejector":"#502e6a",
        "Magazine_Catch_Assembly_fgc9_mki_v1_Magazine_Catch_Bar_1_Body1_":"#502e6a",
        "Magazine_fgc9_mki_v1_Magazine_Body_1_Body1_Magazine_Body":"#502e6a"
    },
    ctrlpew: {
        "Barrel_Assembly":"#939393",
        "Fire_Selector_Assemby":"#f0f2ff",
        "Trigger":"#f0f2ff",
        "FGC-9_Buffer_Tube":"#377b37",
        "FGC-9_Charging_Handle":"#377b37",
        "FGC-9_Lower_Receiver":"#377b37",
        "FGC-9_Stock":"#f0f2ff",
        "FGC-9_Upper_Receiver_Rail":"#377b37",
        "FGC-9_Upper_Receiver":"#f0f2ff",
        "FGC-9_Pistol_Grip":"#f0f2ff",
        "FGC-9_Barrel_Retainer_Oversized_Shaft_Collar_Pocket":"#377b37",
        "Bolt_Carrier_fgc9_mki_v1_Body1_Bolt_Carrier":"#377b37",
        "Ejector_Pivot_fgc9_mki_v1_Body1_Ejector_Pivot":"#377b37",
        "Ejector_fgc9_mki_v1_Body1_Ejector":"#377b37",
        "Magazine_Catch_Assembly_fgc9_mki_v1_Magazine_Catch_Bar_1_Body1_":"#f0f2ff",
        "Magazine_fgc9_mki_v1_Magazine_Body_1_Body1_Magazine_Body":"#f0f2ff"
    },
    clear: {
        "Barrel_Assembly":"#939393",
        "Fire_Selector_Assemby":"#FFFFFF",
        "Trigger":"#FFFFFF",
        "FGC-9_Buffer_Tube":"#FFFFFF",
        "FGC-9_Charging_Handle":"#FFFFFF",
        "FGC-9_Lower_Receiver":"#FFFFFF",
        "FGC-9_Stock":"#FFFFFF",
        "FGC-9_Upper_Receiver_Rail":"#FFFFFF",
        "FGC-9_Upper_Receiver":"#FFFFFF",
        "FGC-9_Pistol_Grip":"#FFFFFF",
        "FGC-9_Barrel_Retainer_Oversized_Shaft_Collar_Pocket":"#FFFFFF",
        "Bolt_Carrier_fgc9_mki_v1_Body1_Bolt_Carrier":"#FFFFFF",
        "Ejector_Pivot_fgc9_mki_v1_Body1_Ejector_Pivot":"#FFFFFF",
        "Ejector_fgc9_mki_v1_Body1_Ejector":"#FFFFFF",
        "Magazine_Catch_Assembly_fgc9_mki_v1_Magazine_Catch_Bar_1_Body1_":"#FFFFFF",
        "Magazine_fgc9_mki_v1_Magazine_Body_1_Body1_Magazine_Body":"#FFFFFF"
    }
};

function setDefaults() {
    var themeSelectorElm = document.getElementById('theme-selector');
    console.log('themeSelectorElm.value',themeSelectorElm.value);
    var theme = themes[themeSelectorElm.value];
    updateColors(theme);
}

function updateColors(theme) {
    console.log('updateColors',theme);
    var values = Object.keys(theme);
    for(var va in values) {
        var prop = values[va];
        var val = theme[prop];
        console.log(prop,val);
        try {
            var elm = document.getElementById(prop);
            elm.value = val;
            updateElementColor(prop,val);
        } catch(e) {

        }
    }
}

function pickedColor(elm) {
    // console.log(elm);
    if(elm.name=="Background") {
        scene.background = new THREE.Color(elm.value);
    } else {
        updateElementColor(elm.name,elm.value)
    }
}

function updateElementColor(name,color) {
    // parts[0].material = new THREE.MeshStandardMaterial({color: 0xff4400});
    var elm = findElementByName(name);
    if(elm) {
        const material = new THREE.MeshPhysicalMaterial({color: color,metalness: 0.3,flatShading:true});
        elm.material = material;
        // elm.material = materialnew THREE.MeshStandardMaterial({color: color});
    }
}

function findElementByName(name) {
    for(var prt in parts) {
        var part = parts[prt];
        // console.log(part.name,name,(part.name==name));
        if(part.name==name) {
            return part;
        }
    };
    return null;
}
</script>
<script type="module">
import * as THREE from "https://unpkg.com/three@0.126.1/build/three.module.js";
import {GLTFLoader} from 'https://unpkg.com/three@0.126.1/examples/jsm/loaders/GLTFLoader.js'
import { OrbitControls } from "https://unpkg.com/three@0.126.1/examples/jsm/controls/OrbitControls.js";
import { DRACOLoader } from 'https://unpkg.com/three@0.126.1/examples/jsm/loaders/DRACOLoader.js'

var mesh, renderer, scene, camera, controls, model;

init();
animate();

function init() {
    window.THREE = THREE;
    const BACKGROUND_COLOR = 0xf1f1f1;
    // renderer
    renderer = new THREE.WebGLRenderer();
    renderer.setSize( window.innerWidth, window.innerHeight );
    renderer.setPixelRatio( window.devicePixelRatio );
    document.body.appendChild( renderer.domElement );

    // scene
    scene = new THREE.Scene();
    window.scene = scene;

    scene.background = new THREE.Color(BACKGROUND_COLOR );
    // scene.fog = new THREE.Fog(BACKGROUND_COLOR, 20, 100);
    
    // camera
    camera = new THREE.PerspectiveCamera( 40, window.innerWidth / window.innerHeight, 1, 10000 );
    camera.position.set( 160, 120, 100 );

    // controls
    controls = new OrbitControls( camera, renderer.domElement );
    controls.screenSpacePanning = true;
    
    // ambient
    var amLight = new THREE.AmbientLight( 0xFFFFFF, .5 );
    // window.amLight = amLight;
    scene.add(amLight);
    
    // light
    var light = new THREE.DirectionalLight( 0xffffff, 0.5 );
    light.position.set( 20,20, 0 );
    scene.add( light );

    var light1 = new THREE.DirectionalLight( 0xffffff, 0.5 );
    light1.position.set( -20,-20, 0 );
    scene.add( light1 );

    
    const light2 = new THREE.DirectionalLight( 0xc1c1c1, 0.5 );
    light2.castShadow = true;
    scene.add( light2 );

    
let model;
let loader = new GLTFLoader();
let modelName = "fgc9_3d_model_v5-processed.gltf";

loader.setDRACOLoader( new DRACOLoader() );



loader.load(modelName, function(gltf){
    model = gltf.scene;
    model.scale.set(0.5,0.5,0.5);
    model.position.y = 0;
    model.position.x = 0;
    model.position.z = 0;
    model.quaternion.set(0,0,0,0);
    window.model = model;

gltf.scene.traverse( ( object ) => {
    console.log(object);
if ( object.isMesh ) {
    object.material.color.set( 0xffffff * Math.random() );
    console.log(object.name);
    // object.material = new THREE.MeshStandardMaterial({color: 0xffffff * Math.random()});
    object.material = new THREE.MeshStandardMaterial({color: 0xffffff});
    // object.material = texMat;
    parts.push(object);
}
} );
  scene.add(gltf.scene);
  setDefaults();
  //animate();
});

    
}

function animate() {
    requestAnimationFrame( animate );
    controls.update();
    renderer.render( scene, camera );
}
    </script>
    <script>
        document.getElementById('clear-colors').addEventListener('click', function (event) {
            updateColors(themes.clear);
        });
        document.getElementById('theme-selector').addEventListener('change', function (event) {
            setDefaults();
        });
    </script>
</body>
</html>